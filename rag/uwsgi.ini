[uwsgi]
chdir = /rag
module = app:app
master = true
processes = 4
socket = /tmp/rag.sock
chmod-socket = 666
vacuum = true
die-on-term = true
protocol = fastcgi
lazy-apps = false
enable-threads = true
thunder-lock = true
buffer-size = 65535
harakiri = 300
post-buffering = 4096
max-requests = 500
reload-on-rss = 400
reload-on-as = 512
reload-mercy = 8
socket-timeout = 300

# 메모리 관련 설정 추가
memory-report = true
single-interpreter = true
py-call-osafterfork = true

# 로깅 설정
log-5xx = true 
log-4xx = true
log-date = true
log-slow = true
log-x-forwarded-for = true

# 스레드 문제 해결
threads = 4
thread-stacksize = 2048
worker-reload-mercy = 60
